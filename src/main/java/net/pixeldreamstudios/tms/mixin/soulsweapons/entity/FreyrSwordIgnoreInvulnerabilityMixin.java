package net.pixeldreamstudios.tms.mixin.soulsweapons.entity;

import net.minecraft.entity.LivingEntity;
import net.minecraft.world.World;
import net.soulsweaponry.entity.ai.goal.FreyrSwordGoal;
import net.soulsweaponry.entity.mobs.FreyrSwordEntity;
import org.spongepowered.asm.mixin.Final;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.Shadow;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin(FreyrSwordGoal.class)
public class FreyrSwordIgnoreInvulnerabilityMixin {

    @Shadow @Final private FreyrSwordEntity entity;

    @Inject(
            method = "attackTarget",
            at = @At(
                    value = "INVOKE",
                    target = "Lnet/minecraft/entity/LivingEntity;damage(Lnet/minecraft/entity/damage/DamageSource;F)Z"
            )
    )
    private void resetInvulnerabilityBeforeDamage(LivingEntity target, World world, CallbackInfo ci) {
            target.timeUntilRegen = 0;
    }
}